!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.IpfsBlockService=n():t.IpfsBlockService=n()}(window,(function(){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(o,r,function(n){return t[n]}.bind(null,r));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){t.exports=e(1)},function(t,n,e){"use strict";const{map:o}=e(2),r=e(3);t.exports=class{constructor(t){this._repo=t,this._bitswap=null}setExchange(t){this._bitswap=t}unsetExchange(){this._bitswap=null}hasExchange(){return null!=this._bitswap}put(t,n){return this.hasExchange()?this._bitswap.put(t,n):this._repo.blocks.put(t,n)}putMany(t,n){return this.hasExchange()?this._bitswap.putMany(t,n):this._repo.blocks.putMany(t,n)}get(t,n){return this.hasExchange()?this._bitswap.get(t,n):this._repo.blocks.get(t,n)}getMany(t,n){if(!Array.isArray(t))throw new Error("first arg must be an array of cids");if(this.hasExchange())return this._bitswap.getMany(t,n);return o(t=>this._repo.blocks.get(t,n))(t)}async delete(t,n){if(!await this._repo.blocks.has(t))throw r(new Error("blockstore: block not found"),"ERR_BLOCK_NOT_FOUND");return this._repo.blocks.delete(t,n)}deleteMany(t,n){const e=this._repo;return this._repo.blocks.deleteMany(async function*(){for await(const n of t){if(!await e.blocks.has(n))throw r(new Error("blockstore: block not found"),"ERR_BLOCK_NOT_FOUND");yield n}}(),n)}}},function(t,n,e){"use strict";function o(t,n){return void 0===n?n=>o(t,n):n[Symbol.asyncIterator]?async function*(t,n){let e=[];for await(const o of n)e.push(o),e.length===t&&(yield e,e=[]);e.length>0&&(yield e)}(t,n):function*(t,n){let e=[];for(const o of n)e.push(o),e.length===t&&(yield e,e=[]);e.length>0&&(yield e)}(t,n)}function r(t){if("function"==typeof t.next)return t;if("function"==typeof t[Symbol.iterator])return t[Symbol.iterator]();if("function"==typeof t[Symbol.asyncIterator])return t[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function i(){let t,n;return{promise:new Promise((e,o)=>{n=e,t=o}),reject:t,resolve:n}}function c(t,n){const e=r(n),o=[],c=[];let u=!1,s=!1;async function a(){if(!s&&!(u||o.length>=t)){u=!0;try{const{done:t,value:n}=await e.next();t?s=!0:o.push({value:n})}catch(n){s=!0,o.push({error:n})}!function(){for(;c.length>0&&o.length>0;){const t=c.shift(),{error:n,value:e}=o.shift();n?t.reject(n):t.resolve({done:!1,value:e})}for(;c.length>0&&s;){const{resolve:t}=c.shift();t({done:!0,value:void 0})}}(),u=!1,a()}}const f={next:async function(){if(o.length>0){const{error:t,value:n}=o.shift();if(t)throw t;return a(),{done:!1,value:n}}if(s)return{done:!0,value:void 0};const t=i();return c.push(t),a(),t.promise},[Symbol.asyncIterator]:()=>f};return f}function u(t,n){return void 0===n?n=>u(t,n):n[Symbol.asyncIterator]?c(t,n):function*(t,n){const e=[];let o;try{for(const o of n)e.push(o),e.length<=t||(yield e.shift())}catch(r){o=r}for(const i of e)yield i;if(o)throw o}(t,n)}function s(t){return t[Symbol.asyncIterator]?async function(t){const n=[];for await(const e of t)n.push(e);return n}(t):Array.from(t)}function a(...t){return t.find(t=>void 0!==t[Symbol.asyncIterator])?async function*(t){for await(const n of t)yield*n}(t):function*(t){for(const n of t)yield*n}(t)}function f(t){if(t[Symbol.asyncIterator])return async function(t){for await(const n of t);}(t);for(const n of t);}async function*l(t,n){for await(const e of n)await t(e)&&(yield e)}function d(t,n){return void 0===n?n=>l(t,n):l(t,n)}async function*y(t){for await(const n of t)n&&"string"!=typeof n&&(n[Symbol.iterator]||n[Symbol.asyncIterator])?yield*y(n):yield n}async function*h(t,n){for await(const e of n)yield await t(e)}function p(t,n){return void 0===n?n=>h(t,n):h(t,n)}function b(t,n){return void 0===n?n=>b(t,n):d(t=>null!=t,y(p(t,n)))}function v(t,n,e){const o=r(e),c=[],u=[];let s=!1,a=!1,f=0,l=null;function d(){for(;u.length>0&&c.length>0;){const{resolve:t}=u.shift();t({done:!1,value:c.shift()})}for(;u.length>0&&0===f&&s;){const{resolve:t,reject:n}=u.shift();l?(n(l),l=null):t({done:!0,value:void 0})}}async function y(){if(s)d();else if(!(a||f+c.length>=t)){a=!0,f++;try{const{done:t,value:e}=await o.next();t?(s=!0,f--,d()):async function(t){try{const e=await n(t);if(e&&e[Symbol.asyncIterator])for await(const t of e)c.push(t);else c.push(e)}catch(e){s=!0,l=e}f--,d(),y()}(e)}catch(e){s=!0,f--,l=e,d()}a=!1,y()}}const h={next:async function(){if(0===c.length){const t=i();return u.push(t),y(),t.promise}const t=c.shift();return y(),{done:!1,value:t}},[Symbol.asyncIterator]:()=>h};return h}function w(t,n,e){return void 0===n?(n,e)=>e?w(t,n,e):w(t,n):void 0===e?e=>w(t,n,e):d(t=>null!=t,y(v(t,n,e)))}async function m(t){return new Promise(n=>{t.once("readable",()=>{n()})})}function g(t){return"function"==typeof t[Symbol.asyncIterator]?t:async function*(t){for(;;){const n=t.read();if(null===n){if(t._readableState.ended)break;await m(t)}else yield n}}(t)}async function*S(...t){const n=new Set(t.map(r));for(;n.size>0;)for(const t of n){const e=await t.next();e.done?n.delete(t):yield e.value}}function x(t,...n){let e=t();for(const o of n)e=o(e);return e}function _(t,n,e){return void 0===n?(n,e)=>_(t,n,e):void 0===e?e=>_(t,n,e):async function*(t,n,e){let o=null;const i=r(x(()=>e,u(1),(async function*(t){for await(const n of t){if(o)return;yield n}}),p(t=>({value:n(t)})),u(t)));for(;;){const{value:t,done:n}=await i.next();if(n)break;try{const n=await t.value;o||(yield n)}catch(c){o=c}}if(o)throw o}(t,n,e)}function k(t,n,e){return void 0===n?(n,e)=>e?k(t,n,e):k(t,n):void 0===e?e=>k(t,n,e):d(t=>null!=t,y(_(t,n,e)))}async function*I(...t){const n=t.map(r),e=new Set,o=new Map;let i=null,c=null,u=null;const s=t=>{i=t,c&&c(t)},a=t=>{u&&u(t)},f=t=>{const n=Promise.resolve(t.next()).then(async({done:r,value:i})=>{r||o.set(t,i),e.delete(n)});e.add(n),n.then(a,s)};for(const r of n)f(r);for(;;){if(0===e.size&&0===o.size)return;await new Promise((t,n)=>{if(i&&n(i),o.size>0)return t();u=t,c=n});for(const[t,n]of o)o.delete(t),yield n,f(t)}}async function j(t,n,e){let o=n;for await(const r of e)o=await t(o,r);return o}function O(t,n,e){return void 0===n?(n,e)=>e?j(t,n,e):O(t,n):void 0===e?e=>O(t,n,e):j(t,n,e)}function M(t,n){return void 0===n?n=>M(t,n):n[Symbol.asyncIterator]?async function*(t,n){let e=0;for await(const o of n)if(yield await o,e++,e>=t)break}(t,n):function*(t,n){let e=0;for(const o of n)if(yield o,e++,e>=t)break}(t,n)}async function*E(t,n){for await(const e of n)await t(e),yield e}function P(t,n){return void 0===n?n=>E(t,n):E(t,n)}function T(t,n){let e=t[0]+n[0],o=t[1]+n[1];if(o>=1e9){const t=o%1e9;e+=(o-t)/1e9,o=t}return[e,o]}function z(t={},n){return void 0===n?n=>z(t,n):void 0!==n[Symbol.asyncIterator]?async function*(t,n){const e=n[Symbol.asyncIterator]();let o=[0,0];for(;;){const n=process.hrtime(),{value:r,done:i}=await e.next(),c=process.hrtime(n);if(o=T(o,c),t.progress&&t.progress(c,o),i)return t.total&&t.total(o),r;yield r}}(t,n):function*(t,n){const e=n[Symbol.iterator]();let o=[0,0];for(;;){const n=process.hrtime(),{value:r,done:i}=e.next(),c=process.hrtime(n);if(o=T(o,c),t.progress&&t.progress(c,o),i)return t.total&&t.total(o),r;yield r}}(t,n)}function B(t,n,e){const o=r(e),c=[],u=[];let s=!1,a=!1,f=0,l=null;function d(){for(;u.length>0&&c.length>0;){const{resolve:t}=u.shift();t({done:!1,value:c.shift()})}for(;u.length>0&&0===f&&s;){const{resolve:t,reject:n}=u.shift();l?(n(l),l=null):t({done:!0,value:void 0})}}async function y(){if(s)d();else if(!(a||f+c.length>=t)){a=!0,f++;try{const{done:t,value:e}=await o.next();t?(s=!0,f--,d()):async function(t){try{const e=await n(t);c.push(e)}catch(e){s=!0,l=e}f--,d(),y()}(e)}catch(e){s=!0,f--,l=e,d()}a=!1,y()}}const h={next:async function(){if(0===c.length){const t=i();return u.push(t),y(),t.promise}const t=c.shift();return y(),{done:!1,value:t}},[Symbol.asyncIterator]:()=>h};return h}function L(t,n,e){return void 0===n?(n,e)=>e?L(t,n,e):L(t,n):void 0===e?e=>L(t,n,e):B(t,n,e)}async function N(t,n){let e=null,o=null,r=null;const i=t=>{e=t,o&&o(t)},c=()=>{r&&r()};t.once("error",i);for await(const u of n)if(!1===t.write(u)&&await new Promise((n,i)=>{if(e)return i(e);t.once("drain",c),r=n,o=i}),e)break;if(t.removeListener("error",i),t.removeListener("drain",c),e)throw e}function R(t,n){return void 0===n?n=>N(t,n):N(t,n)}e.r(n),e.d(n,"batch",(function(){return o})),e.d(n,"buffer",(function(){return u})),e.d(n,"collect",(function(){return s})),e.d(n,"concat",(function(){return a})),e.d(n,"consume",(function(){return f})),e.d(n,"filter",(function(){return d})),e.d(n,"flatMap",(function(){return b})),e.d(n,"flatTransform",(function(){return w})),e.d(n,"flatten",(function(){return y})),e.d(n,"fromStream",(function(){return g})),e.d(n,"getIterator",(function(){return r})),e.d(n,"map",(function(){return p})),e.d(n,"merge",(function(){return S})),e.d(n,"parallelFlatMap",(function(){return k})),e.d(n,"parallelMap",(function(){return _})),e.d(n,"parallelMerge",(function(){return I})),e.d(n,"pipeline",(function(){return x})),e.d(n,"reduce",(function(){return O})),e.d(n,"take",(function(){return M})),e.d(n,"tap",(function(){return P})),e.d(n,"time",(function(){return z})),e.d(n,"transform",(function(){return L})),e.d(n,"writeToStream",(function(){return R}))},function(t,n,e){"use strict";function o(t,n){for(const e in n)Object.defineProperty(t,e,{value:n[e],enumerable:!0,configurable:!0});return t}t.exports=function(t,n,e){if(!t||"string"==typeof t)throw new TypeError("Please pass an Error to err-code");e||(e={}),"object"==typeof n&&(e=n,n=void 0),null!=n&&(e.code=n);try{return o(t,e)}catch(r){e.message=t.message,e.stack=t.stack;const n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(t)),o(new n,e)}}}])}));