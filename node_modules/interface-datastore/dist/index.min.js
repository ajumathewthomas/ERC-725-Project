!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.InterfaceDatastore=e():t.InterfaceDatastore=e()}(self,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e,r){"use strict";const n=r(11),o=r(12),s=r(4);e.utf8Encoder=new o("utf8"),e.utf8Decoder=new s("utf8"),e.filter=(t,e)=>async function*(){for await(const r of t){await e(r)&&(yield r)}}(),e.sortAll=(t,e)=>async function*(){let r=[];for await(const e of t)r.push(e);r=await e(r);for(const t of r)yield t}(),e.take=(t,e)=>async function*(){if(e<=0)return;let r=0;for await(const n of t)if(yield n,r++,r>=e)return}(),e.map=(t,e)=>async function*(){for await(const r of t)yield e(r)}(),e.replaceStartWith=function(t,e){const r=new RegExp("^"+e);return t.replace(r,"")},e.tmpdir=n},function(t,e,r){"use strict";const{nanoid:n}=r(2),o=r(10),{utf8Encoder:s,utf8Decoder:i}=r(0),a=r(4),c=s.encode("/"),u=c[0];class l{constructor(t,e){if("string"==typeof t)this._buf=s.encode(t);else{if(!(t instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=t}if(null==e&&(e=!0),e&&this.clean(),0===this._buf.byteLength||this._buf[0]!==u)throw new Error("Invalid key")}toString(t="utf8"){return"utf8"===t||"utf-8"===t?i.decode(this._buf):new a(t).decode(this._buf)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(t){return new f(t.join("/"))}static random(){return new f(n().replace(/-/g,""))}clean(){if(this._buf&&0!==this._buf.byteLength||(this._buf=c),this._buf[0]!==u){const t=new Uint8Array(this._buf.byteLength+1);t.fill(u,0,1),t.set(this._buf,1),this._buf=t}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===u;)this._buf=this._buf.subarray(0,-1)}less(t){const e=this.list(),r=t.list();for(let n=0;n<e.length;n++){if(r.length<n+1)return!1;const t=e[n],o=r[n];if(t<o)return!0;if(t>o)return!1}return e.length<r.length}reverse(){return l.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const t=this.namespaces();return t[t.length-1]}list(){return this.toString().split("/").slice(1)}type(){return function(t){const e=t.split(":");if(e.length<2)return"";return e.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(t){const e=t.split(":");return e[e.length-1]}(this.baseNamespace())}instance(t){return new f(this.toString()+":"+t)}path(){let t=this.parent().toString();return t.endsWith("/")||(t+="/"),t+=this.type(),new f(t)}parent(){const t=this.list();return 1===t.length?new f("/"):new f(t.slice(0,-1).join("/"))}child(t){return"/"===this.toString()?t:"/"===t.toString()?this:new f(this.toString()+t.toString(),!1)}isAncestorOf(t){return t.toString()!==this.toString()&&t.toString().startsWith(this.toString())}isDecendantOf(t){return t.toString()!==this.toString()&&this.toString().startsWith(t.toString())}isTopLevel(){return 1===this.list().length}concat(...t){return l.withNamespaces([...this.namespaces(),...(e=t.map(t=>t.namespaces()),[].concat(...e))]);var e}}const f=o(l,{className:"Key",symbolName:"@ipfs/interface-datastore/key"});t.exports=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"urlAlphabet",{enumerable:!0,get:function(){return n.urlAlphabet}}),e.random=e.customRandom=e.customAlphabet=e.nanoid=void 0;var n=r(9);let o=t=>crypto.getRandomValues(new Uint8Array(t));e.random=o;let s=(t,e,r)=>{let n=(2<<Math.log(t.length-1)/Math.LN2)-1,o=-~(1.6*n*e/t.length);return()=>{let s="";for(;;){let i=r(o),a=o;for(;a--;)if(s+=t[i[a]&n]||"",s.length===+e)return s}}};e.customRandom=s;e.customAlphabet=(t,e)=>s(t,e,o);e.nanoid=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let n=63&r[t];e+=n<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n<63?"_":"-"}return e}},function(t,e,r){"use strict";"object"!=typeof globalThis&&(Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__),t.exports=globalThis},function(t,e,r){"use strict";t.exports=r(3).TextDecoder},function(t,e,r){"use strict";const{filter:n,sortAll:o,take:s,map:i}=r(0),a=r(14);t.exports=class{async open(){}async close(){}async put(t,e,r={}){}async*putMany(t,e={}){for await(const{key:r,value:n}of t)await this.put(r,n,e),yield{key:r,value:n}}async get(t,e={}){}async*getMany(t,e={}){for await(const r of t)yield this.get(r,e)}async has(t){}async delete(t,e={}){}async*deleteMany(t,e={}){for await(const r of t)await this.delete(r,e),yield r}batch(){let t=[],e=[];return{put(e,r){t.push({key:e,value:r})},delete(t){e.push(t)},commit:async r=>{await a(this.putMany(t,r)),t=[],await a(this.deleteMany(e,r)),e=[]}}}async*_all(t,e){}async*query(t,e){let r=this._all(t,e);if(null!=t.prefix&&(r=n(r,e=>e.key.toString().startsWith(t.prefix))),Array.isArray(t.filters)&&(r=t.filters.reduce((t,e)=>n(t,e),r)),Array.isArray(t.orders)&&(r=t.orders.reduce((t,e)=>o(t,e),r)),null!=t.offset){let e=0;r=n(r,()=>e++>=t.offset)}null!=t.limit&&(r=s(r,t.limit)),!0===t.keysOnly&&(r=i(r,t=>({key:t.key}))),yield*r}}},function(t,e,r){"use strict";const n=r(15);t.exports.dbOpenFailedError=t=>(t=t||new Error("Cannot open database"),n(t,"ERR_DB_OPEN_FAILED")),t.exports.dbDeleteFailedError=t=>(t=t||new Error("Delete failed"),n(t,"ERR_DB_DELETE_FAILED")),t.exports.dbWriteFailedError=t=>(t=t||new Error("Write failed"),n(t,"ERR_DB_WRITE_FAILED")),t.exports.notFoundError=t=>(t=t||new Error("Not Found"),n(t,"ERR_NOT_FOUND")),t.exports.abortedError=t=>(t=t||new Error("Aborted"),n(t,"ERR_ABORTED"))},function(t,e,r){t.exports=r(8)},function(t,e,r){"use strict";const n=r(1),o=r(13),s=r(0),i=r(6),a=r(5);e.Key=n,e.MemoryDatastore=o,e.utils=s,e.Errors=i,e.Adapter=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.urlAlphabet=void 0;e.urlAlphabet="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"},function(t,e,r){"use strict";t.exports=function(t,{className:e,symbolName:r}){const n=Symbol.for(r),o={[e]:class extends t{constructor(...t){super(...t),Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return o["is"+e]=t=>!(!t||!t[n]),o},t.exports.proto=function(t,{className:e,symbolName:r,withoutNew:n}){const o=Symbol.for(r),s={[e]:function(...e){if(n&&!(this instanceof s))return new s(...e);const r=t.call(this,...e)||this;return r&&!r[o]&&Object.defineProperty(r,o,{value:!0}),r}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get:()=>e}),s["is"+e]=t=>!(!t||!t[o]),s}},function(t,e,r){"use strict";const{nanoid:n}=r(2);t.exports=(t=(t=>t))=>t(n())},function(t,e,r){"use strict";t.exports=r(3).TextEncoder},function(t,e,r){"use strict";const n=r(1),o=r(5),s=r(6);t.exports=class extends o{constructor(){super(),this.data={}}async put(t,e){this.data[t.toString()]=e}async get(t){if(!await this.has(t))throw s.notFoundError();return this.data[t.toString()]}async has(t){return void 0!==this.data[t.toString()]}async delete(t){delete this.data[t.toString()]}*_all(){yield*Object.entries(this.data).map(([t,e])=>({key:new n(t),value:e}))}}},function(t,e,r){"use strict";t.exports=async t=>{for await(const e of t);}},function(t,e,r){"use strict";function n(t,e){for(const r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}t.exports=function(t,e,r){if(!t||"string"==typeof t)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"==typeof e&&(r=e,e=void 0),null!=e&&(r.code=e);try{return n(t,r)}catch(o){r.message=t.message,r.stack=t.stack;const e=function(){};return e.prototype=Object.create(Object.getPrototypeOf(t)),n(new e,r)}}}])}));